# Gate.io æœŸè´§ä»·å·®äº¤æ˜“ç³»ç»Ÿ - ä½¿ç”¨æŒ‡å—

## ğŸ¯ ç³»ç»Ÿæ¦‚è¿°

æœ¬ç³»ç»ŸåŸºäºGate.ioå®˜æ–¹APIå®ç°ï¼Œä¸“é—¨é’ˆå¯¹æœŸè´§ä»·å·®å¥—åˆ©äº¤æ˜“è®¾è®¡ï¼Œæ ¸å¿ƒåŠŸèƒ½æ˜¯ï¼š

- **ä»·å·®åˆ¤æ–­**: `|å–ä»· - æŒä»“ä»·| / æŒä»“ä»· â‰¤ 0.05%` æ—¶è‡ªåŠ¨å–å‡º
- **è‡ªåŠ¨äº¤æ˜“**: ä¹°å…¥å¼€ä»“ â†’ ç›‘æ§ä»·å·® â†’ è¾¾åˆ°é˜ˆå€¼è‡ªåŠ¨å¹³ä»“
- **æ¬¡æ•°æ§åˆ¶**: å¯è®¾ç½®äº¤æ˜“æ¬¡æ•°ï¼Œå®Œæˆåè‡ªåŠ¨åœæ­¢
- **é£é™©æ§åˆ¶**: å®Œæ•´çš„é£æ§æœºåˆ¶å’Œé”™è¯¯å¤„ç†

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. ç¯å¢ƒå‡†å¤‡

```bash
# å®‰è£…å¿…è¦çš„PythonåŒ…
pip install websocket-client requests

# ç¡®ä¿Pythonç‰ˆæœ¬ >= 3.7
python --version
```

### 2. é…ç½®æ–‡ä»¶è®¾ç½®

ç¼–è¾‘ `config.json` æ–‡ä»¶ï¼š

```json
{
    "api": {
        "url": "wss://ws-testnet.gate.com/v4/ws/futures/usdt",
        "key": "YOUR_API_KEY",
        "secret": "YOUR_API_SECRET"
    },
    "trading": {
        "contracts": ["BTC_USDT"],
        "amount": 1,
        "max_trades": 10,
        "spread_threshold": 0.0005,
        "stop_loss": 0.02
    },
    "risk": {
        "max_position_size": 10,
        "max_loss_per_trade": 100,
        "max_daily_loss": 500,
        "max_leverage": 10,
        "min_balance_ratio": 0.2,
        "cooling_period": 60,
        "max_slippage": 0.001,
        "volatility_threshold": 0.03
    }
}
```

### 3. åŸºæœ¬ä½¿ç”¨

```bash
# ä½¿ç”¨é»˜è®¤é…ç½®å¯åŠ¨
python enhanced_futures_trader.py

# æŒ‡å®šé…ç½®æ–‡ä»¶
python enhanced_futures_trader.py --config my_config.json

# è‡ªå®šä¹‰å‚æ•°
python enhanced_futures_trader.py \
    --contracts BTC_USDT ETH_USDT \
    --amount 2 \
    --max-trades 5 \
    --spread-threshold 0.0003
```

## ğŸ“Š æ ¸å¿ƒåŠŸèƒ½è¯¦è§£

### 1. ä»·å·®è®¡ç®—é€»è¾‘

```python
def calculate_spread_percentage(self, current_price, entry_price):
    """è®¡ç®—ä»·å·®ç™¾åˆ†æ¯”"""
    spread = abs(current_price - entry_price)
    spread_percentage = (spread / entry_price) * 100
    return spread_percentage
```

**è§¦å‘æ¡ä»¶**: `spread_percentage <= 0.05%` æ—¶æ‰§è¡Œå–å‡º

### 2. ä¹°å…¥å¼€ä»“æµç¨‹

- æ£€æŸ¥å½“å‰æ˜¯å¦æœ‰æŒä»“
- æ£€æŸ¥äº¤æ˜“æ¬¡æ•°é™åˆ¶
- ä½¿ç”¨å½“å‰å–ä¸€ä»·ä½œä¸ºä¹°å…¥ä»·
- ä¸‹IOCï¼ˆç«‹å³æˆäº¤æˆ–å–æ¶ˆï¼‰è®¢å•
- è®°å½•æŒä»“æˆæœ¬å’Œå…¥åœºæ—¶é—´

### 3. å–å‡ºå¹³ä»“æµç¨‹

- æ£€æŸ¥å½“å‰æŒä»“çŠ¶æ€
- å®æ—¶è®¡ç®—ä»·å·®ç™¾åˆ†æ¯”
- å½“ä»·å·®â‰¤0.05%æ—¶è§¦å‘å–å‡º
- ä½¿ç”¨å½“å‰ä¹°ä¸€ä»·ä½œä¸ºå–å‡ºä»·
- è®¡ç®—å¹¶è®°å½•ç›ˆäº

### 4. æ¬¡æ•°æ§åˆ¶æœºåˆ¶

```python
# å…¨å±€äº¤æ˜“è®¡æ•°å™¨
self.trade_count = 0
self.max_trades = config['trading']['max_trades']

# æ¯æ¬¡äº¤æ˜“åæ›´æ–°
self.trade_count += 1
if self.trade_count >= self.max_trades:
    self.stop_trading()
```

## ğŸ“ˆ å®æ—¶ç›‘æ§åŠŸèƒ½

### 1. è¡Œæƒ…ç›‘æ§

ç³»ç»Ÿä¼šå®æ—¶ç›‘æ§ä»¥ä¸‹æ•°æ®ï¼š
- æœ€æ–°ä»·æ ¼ (last)
- ä¹°ä¸€ä»· (highest_bid)
- å–ä¸€ä»· (lowest_ask)
- 24å°æ—¶æˆäº¤é‡
- ä»·æ ¼å˜åŒ–ç™¾åˆ†æ¯”

### 2. è®¢å•çŠ¶æ€ç›‘æ§

- è®¢å•æäº¤ç¡®è®¤
- æˆäº¤çŠ¶æ€æ›´æ–°
- éƒ¨åˆ†æˆäº¤å¤„ç†
- è®¢å•å–æ¶ˆé€šçŸ¥

### 3. æŒä»“ç®¡ç†

- å®æ—¶æŒä»“å¤§å°
- æŒä»“æˆæœ¬ä»·
- å½“å‰ç›ˆäºè®¡ç®—
- æŒä»“æ—¶é—´ç»Ÿè®¡

## ğŸ›¡ï¸ é£é™©æ§åˆ¶æœºåˆ¶

### 1. åŸºæœ¬é£é™©å‚æ•°

```json
"risk": {
    "max_position_size": 10,        # æœ€å¤§æŒä»“æ•°é‡
    "max_loss_per_trade": 100,      # å•ç¬”æœ€å¤§äºæŸ
    "max_daily_loss": 500,          # æ¯æ—¥æœ€å¤§äºæŸ
    "max_leverage": 10,             # æœ€å¤§æ æ†
    "min_balance_ratio": 0.2,       # æœ€å°ä½™é¢æ¯”ä¾‹
    "cooling_period": 60,           # å†·å´æœŸï¼ˆç§’ï¼‰
    "max_slippage": 0.001,          # æœ€å¤§æ»‘ç‚¹
    "volatility_threshold": 0.03    # æ³¢åŠ¨ç‡é˜ˆå€¼
}
```

### 2. äº¤æ˜“ä¿æŠ¤

- **ä½™é¢æ£€æŸ¥**: ç¡®ä¿æœ‰è¶³å¤Ÿèµ„é‡‘å¼€ä»“
- **æŒä»“é™åˆ¶**: é˜²æ­¢è¶…é™æŒä»“
- **ä»·æ ¼éªŒè¯**: æ£€æŸ¥ä»·æ ¼åˆç†æ€§
- **å¼‚å¸¸å¤„ç†**: å®Œæ•´çš„é”™è¯¯æ¢å¤æœºåˆ¶

### 3. ç½‘ç»œä¿æŠ¤

- **å¿ƒè·³æœºåˆ¶**: æ¯15ç§’å‘é€pingåŒ…
- **é‡è¿é€»è¾‘**: è¿æ¥æ–­å¼€è‡ªåŠ¨é‡è¿
- **è¶…æ—¶å¤„ç†**: è¯·æ±‚è¶…æ—¶è‡ªåŠ¨é‡è¯•
- **æ•°æ®éªŒè¯**: é˜²æ­¢å¼‚å¸¸æ•°æ®å½±å“äº¤æ˜“

## ğŸ“‹ äº¤æ˜“æµç¨‹è¯¦è§£

### å®Œæ•´äº¤æ˜“æµç¨‹

![Spread Trading Workflow](docs/images/spread_trading_workflow.png)

*Source: [spread_trading_workflow.mmd](mermaid_appendix/spread_trading_workflow.mmd)*

è¯¥æµç¨‹å›¾å±•ç¤ºäº†ä»·å·®äº¤æ˜“çš„å®Œæ•´å†³ç­–æµç¨‹ï¼Œä»ç³»ç»Ÿå¯åŠ¨åˆ°äº¤æ˜“æ‰§è¡Œçš„å„ä¸ªç¯èŠ‚ã€‚

### å…³é”®å†³ç­–ç‚¹

1. **ä¹°å…¥åˆ¤æ–­**:
   - æ— æŒä»“ âœ“
   - æœªè¾¾åˆ°æœ€å¤§äº¤æ˜“æ¬¡æ•° âœ“
   - å½“å‰å–ä»·æœ‰æ•ˆ âœ“

2. **å–å‡ºåˆ¤æ–­**:
   - æœ‰æŒä»“ âœ“
   - ä»·å·®â‰¤0.05% âœ“
   - å½“å‰ä¹°ä»·æœ‰æ•ˆ âœ“

## ğŸ“Š æ—¥å¿—å’Œç›‘æ§

### 1. äº¤æ˜“æ—¥å¿—

```
2025-11-11 12:30:15 - INFO - ğŸš€ Gate.ioæœŸè´§ä»·å·®äº¤æ˜“ç³»ç»Ÿå¯åŠ¨
2025-11-11 12:30:16 - INFO - ğŸ”— WebSocketè¿æ¥å·²å»ºç«‹
2025-11-11 12:30:17 - INFO - ğŸ“¡ è®¢é˜…åˆçº¦è¡Œæƒ…: BTC_USDT
2025-11-11 12:30:20 - INFO - ğŸŸ¢ ä¹°å…¥æœºä¼š: BTC_USDT - å¯ä»¥ä¹°å…¥ï¼Œä»·æ ¼: 95000.50
2025-11-11 12:30:21 - INFO - âœ… ä¹°å…¥æˆåŠŸ: BTC_USDT 1 @ 95000.50
2025-11-11 12:31:45 - INFO - ğŸ”´ å–å‡ºæœºä¼š: BTC_USDT - ä»·å·®0.0450% â‰¤ 0.0500%ï¼Œå¯ä»¥å–å‡º
2025-11-11 12:31:46 - INFO - âœ… å–å‡ºæˆåŠŸ: BTC_USDT
2025-11-11 12:31:46 - INFO -    ç›ˆäº: 42.75 USDT (0.0450%)
```

### 2. äº¤æ˜“æ€»ç»“

ç³»ç»Ÿåœæ­¢æ—¶ä¼šè‡ªåŠ¨æ‰“å°è¯¦ç»†çš„äº¤æ˜“æ€»ç»“ï¼š

```
============================================================
ğŸ“Š äº¤æ˜“æ€»ç»“
============================================================
ğŸ“ˆ æ€»äº¤æ˜“æ¬¡æ•°: 10
âœ… ç›ˆåˆ©äº¤æ˜“: 7
âŒ äºæŸäº¤æ˜“: 3
ğŸ’° æ€»ç›ˆäº: 156.23 USDT
ğŸ“Š å¹³å‡ç›ˆäº: 15.62 USDT
ğŸ¯ èƒœç‡: 70.00%

ğŸ“‹ è¯¦ç»†äº¤æ˜“è®°å½•:
  1. BTC_USDT ğŸ“ˆ å…¥åœº: 95000.50 â†’ å‡ºåœº: 95043.25 ç›ˆäº: 42.75 USDT (0.0450%)
  2. BTC_USDT ğŸ“ˆ å…¥åœº: 95120.80 â†’ å‡ºåœº: 95145.60 ç›ˆäº: 24.80 USDT (0.0261%)
  ...
============================================================
```

## âš ï¸ é‡è¦æé†’

### 1. æµ‹è¯•å»ºè®®

- **å…ˆåœ¨æµ‹è¯•ç½‘è¿è¡Œ**: ä½¿ç”¨testnetå……åˆ†æµ‹è¯•ç­–ç•¥
- **å°é¢å®ç›˜**: æµ‹è¯•æˆåŠŸåå†å°é¢å®ç›˜æµ‹è¯•
- **å‚æ•°è°ƒä¼˜**: æ ¹æ®å®é™…æƒ…å†µè°ƒæ•´ä»·å·®é˜ˆå€¼å’Œäº¤æ˜“é‡

### 2. é£é™©è­¦å‘Š

- **å¸‚åœºé£é™©**: æç«¯å¸‚åœºæƒ…å†µä¸‹ä»·å·®å¯èƒ½æ— æ³•è¾¾åˆ°é¢„æœŸ
- **æµåŠ¨æ€§é£é™©**: å¤§é¢äº¤æ˜“å¯èƒ½é¢ä¸´æ»‘ç‚¹é£é™©
- **æŠ€æœ¯é£é™©**: ç½‘ç»œé—®é¢˜å¯èƒ½å½±å“è®¢å•æ‰§è¡Œ
- **APIé™åˆ¶**: æ³¨æ„Gate.io APIçš„è°ƒç”¨é¢‘ç‡é™åˆ¶

### 3. æœ€ä½³å®è·µ

1. **å‚æ•°è®¾ç½®**:
   - ä»·å·®é˜ˆå€¼: å»ºè®®0.03%-0.08%ä¹‹é—´
   - äº¤æ˜“é‡: ä¸è¶…è¿‡è´¦æˆ·ä½™é¢çš„5%
   - æœ€å¤§äº¤æ˜“æ¬¡æ•°: æ ¹æ®é£é™©æ‰¿å—èƒ½åŠ›è®¾ç½®

2. **ç›‘æ§è¦æ±‚**:
   - å®šæœŸæ£€æŸ¥ç³»ç»Ÿæ—¥å¿—
   - ç›‘æ§è´¦æˆ·ä½™é¢å˜åŒ–
   - å…³æ³¨å¸‚åœºå¼‚å¸¸æ³¢åŠ¨

3. **åº”æ€¥é¢„æ¡ˆ**:
   - æ‰‹åŠ¨åœæ­¢æœºåˆ¶: Ctrl+Céšæ—¶åœæ­¢
   - ç´§æ€¥å¹³ä»“: å¿…è¦æ—¶æ‰‹åŠ¨å¤„ç†æŒä»“
   - æŠ€æœ¯æ”¯æŒ: ä¿å­˜æ—¥å¿—ä¾¿äºé—®é¢˜æ’æŸ¥

## ğŸ”§ é«˜çº§é…ç½®

### è‡ªå®šä¹‰äº¤æ˜“ç­–ç•¥

å¯ä»¥é€šè¿‡ä¿®æ”¹ä»¥ä¸‹å‚æ•°å®ç°ä¸ªæ€§åŒ–äº¤æ˜“ï¼š

```python
# ä»·å·®é˜ˆå€¼è°ƒæ•´
self.spread_threshold = Decimal('0.0003')  # 0.03%

# äº¤æ˜“æ•°é‡è®¾ç½®
self.trade_amount = 2  # æ¯æ¬¡äº¤æ˜“2æ‰‹

# æœ€å¤§äº¤æ˜“æ¬¡æ•°
self.max_trades = 20  # æœ€å¤šäº¤æ˜“20æ¬¡
```

### å¤šåˆçº¦æ”¯æŒ

ç³»ç»Ÿæ”¯æŒåŒæ—¶ç›‘æ§å¤šä¸ªåˆçº¦ï¼š

```bash
python enhanced_futures_trader.py --contracts BTC_USDT ETH_USDT ADA_USDT
```

### æ‰¹é‡å‚æ•°è®¾ç½®

```bash
# é«˜é¢‘å°åˆ©æ¨¡å¼
python enhanced_futures_trader.py \
    --amount 1 \
    --max-trades 50 \
    --spread-threshold 0.0003

# ä½é¢‘å¤§åˆ©æ¨¡å¼
python enhanced_futures_trader.py \
    --amount 5 \
    --max-trades 5 \
    --spread-threshold 0.0008
```

---

**ç‰ˆæœ¬**: v2.0 ä»·å·®äº¤æ˜“ç‰ˆ
**æ›´æ–°æ—¶é—´**: 2025-11-11
**é€‚ç”¨ç¯å¢ƒ**: Gate.ioæœŸè´§æµ‹è¯•ç½‘/ç”Ÿäº§ç½‘
**æŠ€æœ¯æ”¯æŒ**: è¯¦ç»†æ—¥å¿—è®°å½•å’Œé”™è¯¯å¤„ç†